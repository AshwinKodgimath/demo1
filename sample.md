drop table if exists $$environment$$_published_standard_bai_sales.s_bai_sales_agg_bcbu_integrated_sales_weekly;
create table $$environment$$_published_standard_bai_sales.s_bai_sales_agg_bcbu_integrated_sales_weekly
(
    cdl_uuid                                        string comment 'universal unique identifier based on cdl_frequency, cdl_effective_date, cdl_run_identifier',
    cdl_frequency                                   string comment 'data processing frequency',
    cdl_effective_date                              string comment 'data processing week',
    cdl_run_identifier                              string comment 'data processing re-run identifier',
    customer_id                                     string comment 'HCM customer id',
    customer_type                                   string comment 'customer type information',
    customer_name                                   string comment 'HCM customer name',
    city                                            string comment 'city information',
    state                                           string comment 'state information',
    zip                                             string comment 'zip code information',
    phone                                           string comment 'phone number of customer',
    customer_status                                 string comment 'active or inactive status of customer',
    metropolitan_statistical_area_name              string comment 'metropolitan statistical area information corresponding to customer-zip code',
    blocked_account                                 string comment 'ims ddd blocked account flag',
    phs                                             string comment 'flag to identify public health service(phs) affiliated customers',
    party_group_code                                string comment 'party group code information of customer',
    party_group_description                         string comment 'party group code description of customer',
    party_type_code                                 string comment 'party type code information of customer',
    party_type_description                          string comment 'party type code description of customer',
    party_subtype_code                              string comment 'party subtype code information of customer',
    party_subtype_description                       string comment 'party subtype code description of customer',
    party_service_code                              string comment 'party service code information of customer',
    party_service_description                       string comment 'party service code description of customer',
    br_segment                                      string comment 'segment classification of account',
    br_sub_segment                                  string comment 'sub segment classification of account',
    br_gpo_flag                                     string comment 'customer contractee name',
    channel_name                                    string comment 'sales channel name',
    market_normalized_name                          string comment 'market bucket for products',
    brand_normalized_name                           string comment 'product name',
    form_strength_normalized_name                   string comment 'product form strength name',
    br_molecule                                     string comment 'product form strength molecule information (s_bai_sales_config_br_molecule_mapping)',
    br_molecule_bucket                              string comment 'product form strength molecule bucket information (s_bai_sales_config_br_molecule_mapping)',
    blue_bone_sf_district_code                      string comment 'customer district code for blue bone sales team',
    blue_bone_sf_district_name                      string comment 'customer district name for blue bone sales team',
    blue_bone_sf_region_code                        string comment 'customer region code for blue bone sales team',
    blue_bone_sf_region_name                        string comment 'customer region name for blue bone sales team',
    blue_bone_sf_nation_code                        string comment 'customer nation code for blue bone sales team',
    blue_bone_sf_nation_name                        string comment 'customer nation name for blue bone sales team',
    red_cardio_spec_base_district_code              string comment 'customer district code for red cardio spec base sales team',
    red_cardio_spec_base_district_name              string comment 'customer district name for red cardio spec base sales team',
    red_cardio_spec_base_region_code                string comment 'customer region code for red cardio spec base sales team',
    red_cardio_spec_base_region_name                string comment 'customer region name for red cardio spec base sales team',
    red_cardio_spec_base_nation_code                string comment 'customer nation code for red cardio spec base sales team',
    red_cardio_spec_base_nation_name                string comment 'customer nation name for red cardio spec base sales team',
    white_bio_spec_base_district_code               string comment 'customer district code for white bio spec base sales team',
    white_bio_spec_base_district_name               string comment 'customer district name for white bio spec base sales team',
    white_bio_spec_base_region_code                 string comment 'customer region code for white bio spec base sales team',
    white_bio_spec_base_region_name                 string comment 'customer region name for white bio spec base sales team',
    white_bio_spec_base_eds_code                    string comment 'customer eds code for white bio spec base sales team',
    white_bio_spec_base_eds_name                    string comment 'customer eds name for white bio spec base sales team',
    white_bio_spec_base_nation_code                 string comment 'customer nation code for white bio spec base sales team',
    white_bio_spec_base_nation_name                 string comment 'customer nation name for white bio spec base sales team',
    red_cardio_spec_base_all_portfolio_target       string comment 'red cardio spec base portfolio target information of customer',
    red_cardio_spec_base_corlanor_early_adopter     string comment 'red cardio spec base corlanor early adopter information of customer',
    red_cardio_spec_base_repatha_early_adopter      string comment 'red cardio spec base repatha early adopter information of customer',
    red_cardio_spec_over_all_portfolio_target       string comment 'red cardio spec over portfolio target information of customer',
    red_cardio_spec_over_corlanor_early_adopter     string comment 'red cardio spec over corlanor early adopter information of customer',
    red_cardio_spec_over_repatha_early_adopter      string comment 'red cardio spec over repatha early adopter information of customer',
    white_bio_spec_base_all_portfolio_target        string comment 'white bio spec base portfolio target information of customer',
    white_bio_spec_base_repatha_early_adopter       string comment 'white bio spec base repatha early adopter information of customer',
    white_bio_spec_over_all_portfolio_target        string comment 'white bio spec over portfolio target information of customer',
    white_bio_spec_over_repatha_early_adopter       string comment 'white bio spec over repatha early adopter information of customer',
    white_bio_bsr_prolia_acct_target                string comment 'white bio bsr prolia acct target information of customer',
    kaiser                                          string comment 'kaiser classification information',
    br_repatha_national_target                      string comment 'red cardio spec base repatha prof target else white bio spec base repatha prof target else white bio spec over repatha prof target else nt',
    br_prolia_national_target                       string comment 'white bio spec base prolia prof target information of customer else nt',
    competitor_flag                                 boolean comment 'flag to identify competitors',
    year                                            string comment 'IMS year of the processing week',
    semester_number                                 string comment 'IMS semester number of the processing data week',
    quarter_number                                  string comment 'IMS quarter number of the processing data week',
    month_number                                    string comment 'IMS month number of the processing data week',
    week_number                                     string comment 'IMS week number of the processing data week',
    transaction_timestamp                           string comment 'IMS week code',
    ddd_source_units                                double comment 'ddd total source units',
    ddd_source_units_uom                            string comment 'units of measurement for ddd_source_units',
    ddd_units                                       double comment 'ddd total units',
    ddd_units_uom                                   string comment 'units of measurement for ddd_units',
    ddd_dollars                                     double comment 'ddd total dollars',
    ddd_dot                                         double comment 'ddd total days of therapy',
    ddd_mcg                                         double comment 'ddd total mcg',
    ddd_normalized_units                            double comment 'ddd total normalized units',
    ddd_normalized_units_uom                        string comment 'units of measurement for ddd_normalized_units',
    chargeback_source_units                         double comment 'chargeback total source units',
    chargeback_source_units_uom                     string comment 'units of measurement for chargeback_source_units',
    chargeback_units                                double comment 'chargeback total units',
    chargeback_units_uom                            string comment 'units of measurement for chargeback_units',
    chargeback_dollars                              double comment 'chargeback total dollars',
    chargeback_dot                                  double comment 'chargeback total days of therapy',
    chargeback_mcg                                  double comment 'chargeback total mcg',
    chargeback_normalized_units                     double comment 'chargeback total normalized units',
    chargeback_normalized_units_uom                 string comment 'units of measurement for chargeback_normalized_units',
    self_reported_source_units                      double comment 'self reported total source units',
    self_reported_source_units_uom                  string comment 'units of measurement for self_reported_source_units',
    self_reported_units                             double comment 'self reported total units',
    self_reported_units_uom                         string comment 'units of measurement for self_reported_units',
    self_reported_dollars                           double comment 'self reported total dollars',
    self_reported_dot                               double comment 'self reported total days of therapy',
    self_reported_mcg                               double comment 'self reported total mcg',
    self_reported_normalized_units                  double comment 'self reported total normalized units',
    self_reported_normalized_units_uom              string comment 'units of measurement for self_reported_normalized_units',
    integrated_units                                double comment 'summation of units where inclusion flag is true',
    integrated_dollars                              double comment 'summation of dollars where inclusion flag is true',
    integrated_dot                                  double comment 'summation of dot where inclusion flag is true',
    integrated_mcg                                  double comment 'summation of mcg where inclusion flag is true',
    integrated_normalized_units                     double comment 'summation of normalized units where inclusion flag is true',
    867_source_units                                double comment '867 total source units',
    867_source_units_uom                            string comment 'units of measurement for 867_source_units',
    867_units                                       double comment '867 total units',
    867_units_uom                                   string comment 'units of measurement for 867_units',
    867_dollars                                     double comment '867 total dollars',
    867_dot                                         double comment '867 total days of therapy',
    867_mcg                                         double comment '867 total mcg',
    867_normalized_units                            double comment '867 total normalized units',
    867_normalized_units_uom                        string comment 'units of measurement for 867_normalized_units',
    phs_units                                       double comment 'public health service(phs) customer units',
    phs_dollars                                     double comment 'public health service(phs) customer dollars',
    phs_dot                                         double comment 'public health service(phs) customer dot',
    phs_mcg                                         double comment 'public health service(phs) customer mcg',
    phs_normalized_units                            double comment 'public health service(phs) customer normalized units',
    pt_cdl_uuid                                     string
)
using parquet options
(
    Type='EXTERNAL',
    path='$$cdl_base_path$$/cdl/published/standard/bai_sales/s_bai_sales_agg_bcbu_integrated_sales_weekly/',
comment='This table captures the details of calls made by Amgen's internal sales team. These are mostly telephonic conversations with customers and has details like the category of messages delivered and notes taken by sales representative about the flow of conversation and next steps if any. The table is refreshed daily. The data maturity of this table is Unified. This is an Amgen defined table.
1. **Time period:** - History maintained1. **Brand name**: -<li>Enbrel1. Aranesp</li>1. **Business Unit: **- IST1. **Transformation**: -<li>Dataset specific rules &ndash; NA1. Unalign (cross dataset) rules - NA</li>1. **Source tables: - **s_activity_remote_sales_call_details present in Activity Data Service' 
This table captures the details of calls made by Amgen's internal sales team. These are mostly telephonic conversations with customers and has details like the category of messages delivered and notes taken by sales representative about the flow of conversation and next steps if any. The table is refreshed daily. The data maturity of this table is Unified. This is an Amgen defined table.
1. **Time period:** - History maintained1. **Brand name**: -<li>Enbrel1. Aranesp</li>1. **Business Unit: **- IST1. **Transformation**: -<li>Dataset specific rules &ndash; NA1. Unalign (cross dataset) rules - NA</li>1. **Source tables: - **s_activity_remote_sales_call_details present in Activity Data Service' 
)
partitioned by (pt_cdl_uuid);
